<!doctype html><html lang=zh-CN><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://www.glowisle.me/favicon.png><title>4Key音游段位单曲成绩计算的程序实现</title><meta name=title content="4Key音游段位单曲成绩计算的程序实现"><meta name=description content="前言
其实这个坑我很早以前就想开了，在我刚开始学编程那会就一直想写一个这个东西。但苦于数学进度没达到，要用到加权平均数，这东西我前两天才学到，之前对数学也一直是懒得学的状态，要不然几乎是看不懂那个算法的。"><meta name=keywords content="Malody,osu,数据结构与算法,"><link rel=canonical href=https://www.glowisle.me/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/><meta property="og:url" content="https://www.glowisle.me/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/"><meta property="og:site_name" content="映屿"><meta property="og:title" content="4Key音游段位单曲成绩计算的程序实现"><meta property="og:description" content="前言 其实这个坑我很早以前就想开了，在我刚开始学编程那会就一直想写一个这个东西。但苦于数学进度没达到，要用到加权平均数，这东西我前两天才学到，之前对数学也一直是懒得学的状态，要不然几乎是看不懂那个算法的。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-07T13:08:07+00:00"><meta property="article:modified_time" content="2025-06-07T13:08:07+00:00"><meta property="article:tag" content="Malody"><meta property="article:tag" content="Osu"><meta property="article:tag" content="数据结构与算法"><meta name=twitter:card content="summary"><meta name=twitter:title content="4Key音游段位单曲成绩计算的程序实现"><meta name=twitter:description content="前言 其实这个坑我很早以前就想开了，在我刚开始学编程那会就一直想写一个这个东西。但苦于数学进度没达到，要用到加权平均数，这东西我前两天才学到，之前对数学也一直是懒得学的状态，要不然几乎是看不懂那个算法的。"><meta itemprop=name content="4Key音游段位单曲成绩计算的程序实现"><meta itemprop=description content="前言 其实这个坑我很早以前就想开了，在我刚开始学编程那会就一直想写一个这个东西。但苦于数学进度没达到，要用到加权平均数，这东西我前两天才学到，之前对数学也一直是懒得学的状态，要不然几乎是看不懂那个算法的。"><meta itemprop=datePublished content="2025-06-07T13:08:07+00:00"><meta itemprop=dateModified content="2025-06-07T13:08:07+00:00"><meta itemprop=wordCount content="2799"><meta itemprop=keywords content="Malody,Osu,数据结构与算法"><meta name=referrer content="no-referrer-when-downgrade"><style>@font-face{font-family:source serif pro;src:url(/fonts/SourceSerifPro-Regular.otf)}div.footnotes hr::before{content:"Footnotes";display:block;font-size:1.5em;color:var(--bold-text-color);margin-top:16px}.recent-posts p{line-height:35px}.recent-posts-item{margin:0;margin-bottom:120px}.recent-post-title{margin:2px 0 -10px}.post-meta{margin-top:20px;margin-bottom:5px}.recent-item{position:relative;margin-bottom:8px;display:flex;align-items:flex-start}.item-link{width:100%;display:inline-block;text-decoration:none;flex:1;overflow:hidden;text-overflow:ellipsis;font-size:1.6em;word-wrap:break-word;white-space:normal;word-wrap:break-word}.post-title a.item-link{width:100%;display:inline-block;text-decoration:none;flex:1;overflow:hidden;text-overflow:ellipsis;font-size:1.6em;word-wrap:break-word;white-space:normal;word-wrap:break-word}.post-date{font-size:.9em;color:#666;display:inline-block;min-width:80px;flex-shrink:0}.recent-empty{text-align:center;font-style:italic}@media(max-width:720px){.post-date{min-width:auto;font-size:.85em}.recent-post-title{font-size:1.05em}.item-link{white-space:normal;overflow:visible}}.post-meta-item svg{display:inline;width:var(--svg-size);height:var(--svg-size)}.post-meta-item{margin-right:.8em;display:inline-block;font-size:var(--font-size-secondary)}.post-tag a{font-size:var(--font-size-secondary)!important}.post-meta-item p{margin:0}.recent-posts .post-meta{margin-bottom:6em}:root{--width-max:700px;--font-primary:"Source Serif Pro", "Source Han Serif SC", serif;--font-secondary:monospace;--font-size-primary:1.15rem;--font-size-secondary:1rem;--body-bg-color:#ffffff;--bold-text-color:#222;--body-text-color:#444;--link-color:#222;--link-visited-color:#222;--table-border-color:#f2f2f2;--table-th-bg-color:#f2f2f2;--img-border-color:#f2f2f2;--code-bg-color:#f2f2f2;--code-text-color:#222;--blockquote-border-color:#666;--blockquote-text-color:#646464;--upvoted-color:#fa8072;--caption-text-color:#666;--toc-text-color:#e5e5e5;--toc-hover-color:#655e5e;--music-bg-hover-light:#e5e5e5;--music-bg-light:rgba(229, 229, 229, 0.5);--music-text-secondary:#666;--music-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),
     0 4px 6px -2px rgba(0, 0, 0, 0.05);--summary-text-color:#4e4e4e;--svg-size:0.85em}.social-icons{margin:15px;margin-top:5px;text-align:center}.social-icons a{padding:5px}.booklist{display:grid;grid-template-columns:repeat(5,1fr);gap:20px}.booklist-item{transform:translateZ(0);transition:transform .25s,box-shadow .25s;box-shadow:0 4px 6px rgba(0,0,0,.1)}.booklist-item img{height:100%}.booklist-item:hover{transform:translateY(-5px)translateZ(20px);box-shadow:0 20px 40px rgba(0,0,0,.5)}.rss-icon{display:inline;font-size:16px;float:right;font-family:var(--font-primary)}img.missing{display:none}nav a,h1.post-title a,.blog-posts li a{text-decoration:none!important}nav a:hover,.post-title a:hover,.blog-posts a:hover{text-decoration:underline .5px!important}.wm{border:1px #d0d7de solid;border-radius:.25em;padding-top:0;padding:1.5vw;background-color:#fffaed;margin-top:1vh}.wm p{margin-top:1px}article p,div.summary{line-height:35px;margin-top:20px;font-weight:400}.item-link{white-space:nowrap;overflow:hidden}h1.post-title{margin-top:2vh;margin-bottom:10px}h1.post-title a{font-weight:700}.recent-list{padding-left:2vw}.recent-item{list-style-type:none}.post-date{display:inline}.post-date,.post-date-shortcode{margin-left:auto}.music-card img{border:none!important}.music-card{display:flex;flex-direction:column;gap:.5rem;width:100%}.music-info{display:flex;align-items:center;gap:1.25rem}.music-cover{width:3.75rem;height:3.75rem;border-radius:.5rem;box-shadow:var(--music-shadow);margin:0!important;object-fit:cover}.music-title{margin:0;font-size:1rem;font-weight:700;line-height:1.2}.music-artist{margin:0;font-size:.875rem;color:var(--music-text-secondary)}.music-links{display:flex;align-items:center;gap:.5rem}.music-btn{display:inline-flex;align-items:center;gap:.25rem;padding:0 .75rem;height:2rem;border-radius:9999px;text-decoration:none!important;font-size:.75rem;transition:background-color .3s ease;background-color:var(--music-bg-light);color:inherit}.music-btn:hover{background-color:var(--music-bg-hover-light)}.music-icon{display:block;width:.75rem;height:.75rem;margin:0!important}.music-btn-text{display:inline}@media(min-width:768px){.music-card{flex-direction:row;justify-content:space-between;align-items:center}.music-btn{padding:1rem;justify-content:center;width:auto;height:auto}.music-icon{width:1.25rem;height:1.25rem}.music-btn-text{display:none}}@media(prefers-color-scheme:dark){:root{--summary-text-color:#c9c6c5;--body-bg-color:#121212;--bold-text-color:#eee;--body-text-color:#e8e6e3;--link-color:#ddd;--link-visited-color:#c3b1ee;--table-border-color:#999;--table-th-bg-color:#999;--img-border-color:#999;--code-bg-color:#141414;--code-text-color:#ddd;--blockquote-border-color:#7b7b7b;--blockquote-text-color:#acacac;--caption-text-color:#aaa;--toc-text-color:#373737;--toc-hover-color:#cac3c3;--music-bg-hover-dark:#525252;--music-bg-dark:rgba(82, 82, 82, 0.5);--music-text-secondary:#a3a3a3;--color-background:var(--body-bg-color) !important}.post-meta-item svg{filter:invert(1)hue-rotate(180deg)}div.summary a{text-decoration:underline .1px #5e5e5e}strong{font-weight:650}.music-btn{background-color:var(--music-bg-dark)}.music-btn:hover{background-color:var(--music-bg-hover-dark)}.category-link{color:#dbdbdb}.wm{background-color:#161b22;border-color:#30363d;color:var(--body-text-color);padding:10px}.wm input{background-color:#010409;border:#30363d 1px solid;color:var(--body-text-color);outline:none;transition:border-color .2s ease-in-out}#webmention-source:focus{border-color:var(--color-accent-fg,#0969da);box-shadow:0 0 0 3px rgba(9,105,218,.1)}.wm button{color:var(--body-text-color);background-color:#161b22;border:#30363d 1px solid}.post-title a,{color:#fff!important}.post-summary{color:var(--text-color-primary)!important}.post-item{border-bottom:1px solid #414141!important}.pagination-link{border:1px solid #414141!important}a{font-weight:500!important}}body{font-family:var(--font-primary);font-size:var(--font-size-primary);margin:auto;padding:20px;max-width:var(--width-max);text-align:left;background-color:var(--body-bg-color);word-wrap:break-word;overflow-wrap:break-word;line-height:1.6;color:var(--body-text-color)}h1,h2,h3,h4,h5,h6,strong,b{color:var(--bold-text-color)}article h1,article h2,article h3,article h4,article h5,article h6{margin:16px 0;margin-top:1.5em}a{color:var(--link-color);cursor:pointer;text-decoration:underline .2px #5e5e5e;transition-duration:.3s;font-weight:600}.posts-list li{margin-bottom:12px}.title{text-align:left;text-decoration:none!important}a.title h1{margin:15px;margin-left:0;font-size:2.15em}header{margin-top:30px;margin-bottom:4vh}.title:hover{text-decoration:none}.title span{font-weight:400}nav{text-align:left;margin-bottom:20px}nav a{margin-right:8px}textarea{width:100%;font-size:16px}input{font-size:14px}article{line-height:1.6}table{width:100%;border-collapse:collapse;border:1px solid var(--table-border-color);border-radius:4px;margin-top:16px}th,td{border:1px solid var(--table-border-color);padding:4px}th{background-color:var(--table-th-bg-color)}hr{border:0;border-top:1px dashed}img{max-width:100%;display:block;margin-left:auto;margin-right:auto;content-visibility:auto;loading:lazy}img[src*="#minipic"]{max-width:50%;margin-left:0;margin-right:auto}.image-caption figcaption{text-align:center;font-style:italic;font-size:.8em;margin-top:.6em;color:var(--caption-text-color)}.image-caption{margin:auto}i{font-style:normal}time{font-family:var(--font-primary);color:var(--body-text-color)}code{font-family:var(--font-secondary);background-color:var(--code-bg-color);color:var(--code-text-color);padding:2px;border-radius:4px}pre code{display:block;padding:16px;white-space:pre-wrap;overflow-x:auto}div.highlight pre{border-radius:4px}div.highlight code{background-color:var(--code-bg-color);color:var(--code-text-color)}blockquote{color:var(--blockquote-text-color);margin:0;margin-top:17px;padding-left:20px;font-style:normal}footer{padding:25px 0;text-align:left;font-size:var(--font-size-secondary)}ul li:has(input){list-style-type:none;margin-left:-25.5px}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex;margin-bottom:8px}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li span.grouped{flex:0 0 80px}ul.blog-posts li a:visited{color:var(--link-visited-color)}ul.blog-posts a{margin-left:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}div.toc{position:fixed;top:50%;left:calc( (100vw + var(--width-max))/2 );transform:translateY(-50%);width:calc((90vw - var(--width-max))/2);max-height:80vh;overflow-y:auto;border:none;padding:0;margin:0;z-index:99;&::-webkit-scrollbar { display:none; } -ms-overflow-style:none;scrollbar-width:none}.toc-nav{padding:1.5rem}.toc-nav ul{list-style:none;padding:0;margin:0}.toc-nav li{margin:8px 0}.toc-nav a{display:block;text-decoration:none;color:transparent;padding:0 12px;transition:all .2s ease;font-size:.9rem;line-height:1.4;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}.toc-nav a{color:var(--toc-text-color)}.toc-nav a::before{content:"";display:inline-block;width:16px;height:4px;background-color:var(--toc-text-color);border-radius:16px;margin-right:12px;vertical-align:middle}.toc-nav ul ul a::before{width:12px;margin-right:16px}.toc-nav ul ul ul a::before{width:8px;margin-right:20px}.toc-nav a,.toc-nav a{text-decoration:none;color:var(--toc-hover-color)}.toc-nav a.active::before,.toc-nav a:hover::before{background-color:var(--toc-hover-color)}button.upvote-btn{margin:0;margin-left:auto;padding:0;border:none;background:0 0;cursor:pointer;display:flex;flex-direction:column;align-items:center;color:var(--body-text-color)}button.upvoted{color:var(--upvoted-color)}span.upvote-count{margin-top:-4px;font-size:smaller}@media(max-width:800px){img[src*="#minipic"]{max-width:100%;margin-left:auto;margin-right:auto}div.toc{display:none}}@media(max-width:700px){.booklist{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}}@media(max-width:400px){.booklist{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}}</style><meta name=msvalidate.01 content="2E1AACF009206F2DDBAAD4B98E881460"><meta name=fediverse:creator content="@Verdant@c7.io"><link rel=prefetch as=image href=https://www.blogsclub.org/badge/www.glowisle.me><link href=https://github.com/yingyu5658 rel=me><link href=https://c7.io/@Verdant rel=me><link rel=webmention href=https://webmention.io/www.glowisle.me/webmention><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css><link rel="shortcut icon" href=/favicon.ico></head><body><main><header><a href=/ class=title><h1>映屿</h1></a><nav><a href=/categories/>分类</a>
<a href=/readings>书单</a>
<a href=/links/>友人</a>
<a href=/archives>归档</a>
<a href=/about>关于</a></nav></header><article class=h-entry><h3 class=post-title><a href=/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/ class=item-link>4Key音游段位单曲成绩计算的程序实现</a></h3><div class=e-content><h2 id=前言>前言</h2><p>其实这个坑我很早以前就想开了，在我刚开始学编程那会就一直想写一个这个东西。但苦于数学进度没达到，要用到加权平均数，这东西我前两天才学到，之前对数学也一直是懒得学的状态，要不然几乎是看不懂那个算法的。</p><p>我手头有一个<a href=https://github.com/Special-Week>Special-Week</a>写的网页版的单曲成绩计算器，就以这个为研究样本吧。以下简称原作者为sw（如有冒犯请联系修改）</p><h2 id=数据结构设计>数据结构设计</h2><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 基础的4k类
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>class</span> Dan4k {
</span></span><span style=display:flex><span>        constructor(key1, key2, key3, key4, danName) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_key1 <span style=color:#7a8478>=</span> key1;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_key2 <span style=color:#7a8478>=</span> key2;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_key3 <span style=color:#7a8478>=</span> key3;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_key4 <span style=color:#7a8478>=</span> key4;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_danName <span style=color:#7a8478>=</span> danName;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>每一个段（LN、Om），sw都单独写了一个内部类，继承Dan4k。</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span> <span style=color:#859289;font-style:italic>// lnDan类
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>class</span> LnDan <span style=color:#e67e80>extends</span> Dan4k {
</span></span><span style=display:flex><span>        constructor(key1, lnKey1, key2, lnKey2, key3, lnKey3, key4, lnKey4, danName) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>super</span>(key1, key2, key3, key4, danName);
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_lnKey1 <span style=color:#7a8478>=</span> lnKey1;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_lnKey2 <span style=color:#7a8478>=</span> lnKey2;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_lnKey3 <span style=color:#7a8478>=</span> lnKey3;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_lnKey4 <span style=color:#7a8478>=</span> lnKey4;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// ma段
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>class</span> MaDan <span style=color:#e67e80>extends</span> Dan4k {
</span></span><span style=display:flex><span>        constructor(key1, key2, key3, key4, name1, name2, name3, name4, danName) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>super</span>(key1, key2, key3, key4, danName);
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name1 <span style=color:#7a8478>=</span> name1;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name2 <span style=color:#7a8478>=</span> name2;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name3 <span style=color:#7a8478>=</span> name3;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name4 <span style=color:#7a8478>=</span> name4;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// reform段
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>class</span> ReformDan <span style=color:#e67e80>extends</span> Dan4k {
</span></span><span style=display:flex><span>        constructor(key1, key2, key3, key4, name1, name2, name3, name4, danName) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>super</span>(key1, key2, key3, key4, danName);
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name1 <span style=color:#7a8478>=</span> name1;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name2 <span style=color:#7a8478>=</span> name2;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name3 <span style=color:#7a8478>=</span> name3;
</span></span><span style=display:flex><span>            <span style=color:#e67e80>this</span>.m_name4 <span style=color:#7a8478>=</span> name4;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// om段
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>class</span> OmDan <span style=color:#e67e80>extends</span> Dan4k {
</span></span><span style=display:flex><span>        constructor(key1, key2, key3, key4, danName) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>super</span>(key1, key2, key3, key4, danName);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>我打算重写的程序不带LN玩了，我自己也没玩过LN，不清楚是什么机制。那就来看看剩下的几个类。</p><p><code>Dan4k</code>类定义了一个段位的基础属性，但是这个参数key1-4是用来做什么在当前上下文暂且不清楚，是第n首歌的物量吧。</p><p>那么由此可以推断，这些类都描述了一个谱面的基本属性：</p><ul><li>物量</li><li>歌曲名称</li><li>段位名称
然后分支匹配数据并计算。我也用C语言实现一个。</li></ul><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#859289;font-style:italic>// 整个段位信息
</span></span></span><span style=display:flex><span><span style=color:#e67e80>typedef</span> <span style=color:#e67e80>struct</span> Dan {
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 段位名字
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>char</span><span style=color:#7a8478>*</span> dan_name; 
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 四首歌的名字，用于匹配数据
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>char</span><span style=color:#7a8478>*</span> song1_name;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>char</span><span style=color:#7a8478>*</span> song2_name;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>char</span><span style=color:#7a8478>*</span> song3_name;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>char</span><span style=color:#7a8478>*</span> song4_name;
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 四首歌的物量
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>int</span> song1_key;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>int</span> song2_key;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>int</span> song3_key;
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>int</span> song4_key;
</span></span><span style=display:flex><span>}Dan;
</span></span></code></pre></div><p>来看看网页版中数据是如何存储的</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// MaDan数据
</span></span></span><span style=display:flex><span>    <span style=color:#e67e80>let</span> MaArr <span style=color:#7a8478>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>813</span>, <span style=color:#d699b6>955</span>, <span style=color:#d699b6>907</span>, <span style=color:#d699b6>654</span>, <span style=color:#b2c98f>&#34;Glitch Nerds&#34;</span>, <span style=color:#b2c98f>&#34;Borealis&#34;</span>, <span style=color:#b2c98f>&#34;Niflheim&#34;</span>, <span style=color:#b2c98f>&#34;Moon&#34;</span>, <span style=color:#b2c98f>&#34;1dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1152</span>, <span style=color:#d699b6>850</span>, <span style=color:#d699b6>950</span>, <span style=color:#d699b6>969</span>, <span style=color:#b2c98f>&#34;Follow Tomorrow&#34;</span>, <span style=color:#b2c98f>&#34;Bronze Coffin&#34;</span>, <span style=color:#b2c98f>&#34;Keigan no Zettaireido&#34;</span>, <span style=color:#b2c98f>&#34;SakuraMirage&#34;</span>, <span style=color:#b2c98f>&#34;2dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1169</span>, <span style=color:#d699b6>1143</span>, <span style=color:#d699b6>974</span>, <span style=color:#d699b6>1347</span>, <span style=color:#b2c98f>&#34;Quon&#34;</span>, <span style=color:#b2c98f>&#34;Genkyoku o Kirikizamu&#34;</span>, <span style=color:#b2c98f>&#34;Gin no Kaze&#34;</span>, <span style=color:#b2c98f>&#34;Adjudicatorz-Danzai-&#34;</span>, <span style=color:#b2c98f>&#34;3dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1400</span>, <span style=color:#d699b6>1402</span>, <span style=color:#d699b6>1685</span>, <span style=color:#d699b6>1599</span>, <span style=color:#b2c98f>&#34;Tenkuu no Yoake&#34;</span>, <span style=color:#b2c98f>&#34;VALLISTA&#34;</span>, <span style=color:#b2c98f>&#34;Crystal World ~Fracture~&#34;</span>, <span style=color:#b2c98f>&#34;Zenithalize&#34;</span>, <span style=color:#b2c98f>&#34;4dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1953</span>, <span style=color:#d699b6>2250</span>, <span style=color:#d699b6>2166</span>, <span style=color:#d699b6>1667</span>, <span style=color:#b2c98f>&#34;Ten Thousand Tons of Anonymous Letters&#34;</span>, <span style=color:#b2c98f>&#34;Chips of Notes&#34;</span>, <span style=color:#b2c98f>&#34;Despair of Elferia&#34;</span>, <span style=color:#b2c98f>&#34;Kamigami no Asobi&#34;</span>, <span style=color:#b2c98f>&#34;5dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1487</span>, <span style=color:#d699b6>1424</span>, <span style=color:#d699b6>1381</span>, <span style=color:#d699b6>1587</span>, <span style=color:#b2c98f>&#34;Sweet Cherry X&#34;</span>, <span style=color:#b2c98f>&#34;Akasagarbha&#34;</span>, <span style=color:#b2c98f>&#34;HELLO EveryOne&#34;</span>, <span style=color:#b2c98f>&#34;DataErr0r&#34;</span>, <span style=color:#b2c98f>&#34;6dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1909</span>, <span style=color:#d699b6>1814</span>, <span style=color:#d699b6>1777</span>, <span style=color:#d699b6>2681</span>, <span style=color:#b2c98f>&#34;Fairy Stage&#34;</span>, <span style=color:#b2c98f>&#34;Xross Infection&#34;</span>, <span style=color:#b2c98f>&#34;Wave&#34;</span>, <span style=color:#b2c98f>&#34;Blue Zenith&#34;</span>, <span style=color:#b2c98f>&#34;7dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1962</span>, <span style=color:#d699b6>1067</span>, <span style=color:#d699b6>2388</span>, <span style=color:#d699b6>1772</span>, <span style=color:#b2c98f>&#34;The Lost Dedicated&#34;</span>, <span style=color:#b2c98f>&#34;The Party We Have Never Seen&#34;</span>, <span style=color:#b2c98f>&#34;Finixe&#34;</span>, <span style=color:#b2c98f>&#34;Ultimate Dream&#34;</span>, <span style=color:#b2c98f>&#34;8dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1799</span>, <span style=color:#d699b6>2023</span>, <span style=color:#d699b6>2283</span>, <span style=color:#d699b6>1787</span>, <span style=color:#b2c98f>&#34;Dusk&#34;</span>, <span style=color:#b2c98f>&#34;Panic Popn Picnic&#34;</span>, <span style=color:#b2c98f>&#34;Kick-ass Kung-Fu Carnival&#34;</span>, <span style=color:#b2c98f>&#34;Yakusoku no kimi&#34;</span>, <span style=color:#b2c98f>&#34;9dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2606</span>, <span style=color:#d699b6>2188</span>, <span style=color:#d699b6>2194</span>, <span style=color:#d699b6>2187</span>, <span style=color:#b2c98f>&#34;Chaser&#34;</span>, <span style=color:#b2c98f>&#34;Loli Fantasy&#34;</span>, <span style=color:#b2c98f>&#34;Daydream&#34;</span>, <span style=color:#b2c98f>&#34;Moon Gate&#34;</span>, <span style=color:#b2c98f>&#34;10dan&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2160</span>, <span style=color:#d699b6>1952</span>, <span style=color:#d699b6>1821</span>, <span style=color:#d699b6>3249</span>, <span style=color:#b2c98f>&#34;Border of Life&#34;</span>, <span style=color:#b2c98f>&#34;Scorpion Dance&#34;</span>, <span style=color:#b2c98f>&#34;The Island of Albatross&#34;</span>, <span style=color:#b2c98f>&#34;beautiful loli thing&#34;</span>, <span style=color:#b2c98f>&#34;ex1&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2871</span>, <span style=color:#d699b6>2024</span>, <span style=color:#d699b6>1871</span>, <span style=color:#d699b6>2452</span>, <span style=color:#b2c98f>&#34;Hitsune no youmeiri&#34;</span>, <span style=color:#b2c98f>&#34;紫阳花-AZISAI-&#34;</span>, <span style=color:#b2c98f>&#34;love&amp;justice&#34;</span>, <span style=color:#b2c98f>&#34;message&#34;</span>, <span style=color:#b2c98f>&#34;ex2&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2327</span>, <span style=color:#d699b6>1593</span>, <span style=color:#d699b6>2166</span>, <span style=color:#d699b6>2200</span>, <span style=color:#b2c98f>&#34;Jumble Rumble&#34;</span>, <span style=color:#b2c98f>&#34;End Time&#34;</span>, <span style=color:#b2c98f>&#34;++&#34;</span>, <span style=color:#b2c98f>&#34;Crow Solace&#34;</span>, <span style=color:#b2c98f>&#34;ex3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2731</span>, <span style=color:#d699b6>2653</span>, <span style=color:#d699b6>2033</span>, <span style=color:#d699b6>2761</span>, <span style=color:#b2c98f>&#34;EDM Jumpers&#34;</span>, <span style=color:#b2c98f>&#34;line-epsilon&#34;</span>, <span style=color:#b2c98f>&#34;Contrapasso -paradiso-&#34;</span>, <span style=color:#b2c98f>&#34;YELL!&#34;</span>, <span style=color:#b2c98f>&#34;ex4&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>3229</span>, <span style=color:#d699b6>2731</span>, <span style=color:#d699b6>2561</span>, <span style=color:#d699b6>2109</span>, <span style=color:#b2c98f>&#34;Satori de Pon!&#34;</span>, <span style=color:#b2c98f>&#34;Legend of Seeker&#34;</span>, <span style=color:#b2c98f>&#34;Crystal World -Fracture-&#34;</span>, <span style=color:#b2c98f>&#34;Wizdomiot&#34;</span>, <span style=color:#b2c98f>&#34;ex5&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1766</span>, <span style=color:#d699b6>1861</span>, <span style=color:#d699b6>3171</span>, <span style=color:#d699b6>1680</span>, <span style=color:#b2c98f>&#34;Sepia&#34;</span>, <span style=color:#b2c98f>&#34;Nopea&#34;</span>, <span style=color:#b2c98f>&#34;Satori Trisis&#34;</span>, <span style=color:#b2c98f>&#34;Death&#34;</span>, <span style=color:#b2c98f>&#34;ex6&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2339</span>, <span style=color:#d699b6>2461</span>, <span style=color:#d699b6>2511</span>, <span style=color:#d699b6>2177</span>, <span style=color:#b2c98f>&#34;Paranoia&#34;</span>, <span style=color:#b2c98f>&#34;Boulafacet&#34;</span>, <span style=color:#b2c98f>&#34;Paraclete -Miracle-&#34;</span>, <span style=color:#b2c98f>&#34;Yumemi no Shonen&#34;</span>, <span style=color:#b2c98f>&#34;ex7&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1929</span>, <span style=color:#d699b6>2380</span>, <span style=color:#d699b6>2710</span>, <span style=color:#d699b6>4675</span>, <span style=color:#b2c98f>&#34;Martail Arts&#34;</span>, <span style=color:#b2c98f>&#34;Gene Disruption&#34;</span>, <span style=color:#b2c98f>&#34;Paradigm Shift&#34;</span>, <span style=color:#b2c98f>&#34;Death Melody&#34;</span>, <span style=color:#b2c98f>&#34;ex8&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>3468</span>, <span style=color:#d699b6>3335</span>, <span style=color:#d699b6>3698</span>, <span style=color:#d699b6>5061</span>, <span style=color:#b2c98f>&#34;Only my railgun&#34;</span>, <span style=color:#b2c98f>&#34;-Purgatorium-&#34;</span>, <span style=color:#b2c98f>&#34;Blue Zenith&#34;</span>, <span style=color:#b2c98f>&#34;Inner Universe&#34;</span>, <span style=color:#b2c98f>&#34;exfin&#34;</span>),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>492</span>, <span style=color:#d699b6>529</span>, <span style=color:#d699b6>595</span>, <span style=color:#d699b6>681</span>, <span style=color:#b2c98f>&#34;Ikitoshi Ikerumono&#34;</span>, <span style=color:#b2c98f>&#34;Rambling Pleat&#34;</span>, <span style=color:#b2c98f>&#34;Yi Meng Qian Xiao&#34;</span>, <span style=color:#b2c98f>&#34;White Eternity&#34;</span>, <span style=color:#b2c98f>&#34;0danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>695</span>, <span style=color:#d699b6>621</span>, <span style=color:#d699b6>718</span>, <span style=color:#d699b6>1279</span>, <span style=color:#b2c98f>&#34;Rex Incoqnito&#34;</span>, <span style=color:#b2c98f>&#34;Koiseyo Otome!&#34;</span>, <span style=color:#b2c98f>&#34;Break&#34;</span>, <span style=color:#b2c98f>&#34;KING&#34;</span>, <span style=color:#b2c98f>&#34;1danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1397</span>, <span style=color:#d699b6>1090</span>, <span style=color:#d699b6>805</span>, <span style=color:#d699b6>1212</span>, <span style=color:#b2c98f>&#34;Stargazer&#34;</span>, <span style=color:#b2c98f>&#34;Seyana&#34;</span>, <span style=color:#b2c98f>&#34;Love Emotion&#34;</span>, <span style=color:#b2c98f>&#34;Mermaid Girl&#34;</span>, <span style=color:#b2c98f>&#34;2danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1055</span>, <span style=color:#d699b6>1489</span>, <span style=color:#d699b6>1288</span>, <span style=color:#d699b6>1789</span>, <span style=color:#b2c98f>&#34;Koi Kou Enishi&#34;</span>, <span style=color:#b2c98f>&#34;Onegai!Kon Kon Oinari-sama&#34;</span>, <span style=color:#b2c98f>&#34;The Last page&#34;</span>, <span style=color:#b2c98f>&#34;Hoshi ga Furanai Machi&#34;</span>, <span style=color:#b2c98f>&#34;3danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1865</span>, <span style=color:#d699b6>1434</span>, <span style=color:#d699b6>1284</span>, <span style=color:#d699b6>1839</span>, <span style=color:#b2c98f>&#34;Umiyuri Kaiteitan&#34;</span>, <span style=color:#b2c98f>&#34;Fire in the sky&#34;</span>, <span style=color:#b2c98f>&#34;Icyxis&#34;</span>, <span style=color:#b2c98f>&#34;The Crimson Empire&#34;</span>, <span style=color:#b2c98f>&#34;4danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1282</span>, <span style=color:#d699b6>1706</span>, <span style=color:#d699b6>1473</span>, <span style=color:#d699b6>1939</span>, <span style=color:#b2c98f>&#34;Platinum Disco&#34;</span>, <span style=color:#b2c98f>&#34;Cute na Kanojo&#34;</span>, <span style=color:#b2c98f>&#34;Reimei Sketchbook&#34;</span>, <span style=color:#b2c98f>&#34;Joker&#34;</span>, <span style=color:#b2c98f>&#34;5danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1694</span>, <span style=color:#d699b6>1636</span>, <span style=color:#d699b6>1803</span>, <span style=color:#d699b6>2115</span>, <span style=color:#b2c98f>&#34;Chocolate Disco&#34;</span>, <span style=color:#b2c98f>&#34;Call Me, Beep Me (If You Wanna Reap Me)&#34;</span>, <span style=color:#b2c98f>&#34;DIE IN THE SEA&#34;</span>, <span style=color:#b2c98f>&#34;unhappy century&#34;</span>, <span style=color:#b2c98f>&#34;6danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1701</span>, <span style=color:#d699b6>1799</span>, <span style=color:#d699b6>2132</span>, <span style=color:#d699b6>1899</span>, <span style=color:#b2c98f>&#34;Don&#39;t Stop The Music&#34;</span>, <span style=color:#b2c98f>&#34;Six Acid Strings&#34;</span>, <span style=color:#b2c98f>&#34;Arkadia [Illusion]&#34;</span>, <span style=color:#b2c98f>&#34;Valkyrie Revolutia&#34;</span>, <span style=color:#b2c98f>&#34;7danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2237</span>, <span style=color:#d699b6>2081</span>, <span style=color:#d699b6>2280</span>, <span style=color:#d699b6>2000</span>, <span style=color:#b2c98f>&#34;Don&#39;t let you down&#34;</span>, <span style=color:#b2c98f>&#34;Yoru ni Kakeru&#34;</span>, <span style=color:#b2c98f>&#34;Snow Veil -Shoujo to Kemono no Mori-&#34;</span>, <span style=color:#b2c98f>&#34;Positive Dance Time&#34;</span>, <span style=color:#b2c98f>&#34;8danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2374</span>, <span style=color:#d699b6>1899</span>, <span style=color:#d699b6>2142</span>, <span style=color:#d699b6>1810</span>, <span style=color:#b2c98f>&#34;Kikai Shoujo Gensou&#34;</span>, <span style=color:#b2c98f>&#34;Cold Planet&#34;</span>, <span style=color:#b2c98f>&#34;Stray Star&#34;</span>, <span style=color:#b2c98f>&#34;Unleashed World&#34;</span>, <span style=color:#b2c98f>&#34;9danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2034</span>, <span style=color:#d699b6>1740</span>, <span style=color:#d699b6>2270</span>, <span style=color:#d699b6>2166</span>, <span style=color:#b2c98f>&#34;Hiensou&#34;</span>, <span style=color:#b2c98f>&#34;Rocky Buinne&#34;</span>, <span style=color:#b2c98f>&#34;Yue Ai Yue Ye&#34;</span>, <span style=color:#b2c98f>&#34;Spin Eternally&#34;</span>, <span style=color:#b2c98f>&#34;10danv3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>1952</span>, <span style=color:#d699b6>2013</span>, <span style=color:#d699b6>1953</span>, <span style=color:#d699b6>2111</span>, <span style=color:#b2c98f>&#34;Scorpion Dance&#34;</span>, <span style=color:#b2c98f>&#34;Tailin no Soul&#34;</span>, <span style=color:#b2c98f>&#34;Eiya no Parade&#34;</span>, <span style=color:#b2c98f>&#34;Onsoku Uchuu Ryokou&#34;</span>, <span style=color:#b2c98f>&#34;ex1v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2107</span>, <span style=color:#d699b6>1953</span>, <span style=color:#d699b6>2386</span>, <span style=color:#d699b6>2674</span>, <span style=color:#b2c98f>&#34;Moments&#34;</span>, <span style=color:#b2c98f>&#34;Towards the Horizon&#34;</span>, <span style=color:#b2c98f>&#34;Torikago&#34;</span>, <span style=color:#b2c98f>&#34;Frontier Explorer&#34;</span>, <span style=color:#b2c98f>&#34;ex2v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2518</span>, <span style=color:#d699b6>2636</span>, <span style=color:#d699b6>2326</span>, <span style=color:#d699b6>2511</span>, <span style=color:#b2c98f>&#34;Edison&#34;</span>, <span style=color:#b2c98f>&#34;INTERNET OVERDOSE&#34;</span>, <span style=color:#b2c98f>&#34;Euthanasia&#34;</span>, <span style=color:#b2c98f>&#34;Fin.ArcDeaR&#34;</span>, <span style=color:#b2c98f>&#34;ex3v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2634</span>, <span style=color:#d699b6>2212</span>, <span style=color:#d699b6>2336</span>, <span style=color:#d699b6>2602</span>, <span style=color:#b2c98f>&#34;ZENITHALIZE&#34;</span>, <span style=color:#b2c98f>&#34;Asymmetrical Grooves&#34;</span>, <span style=color:#b2c98f>&#34;Pure Ruby&#34;</span>, <span style=color:#b2c98f>&#34;EVERLASTING HAPPiNESS&#34;</span>, <span style=color:#b2c98f>&#34;ex4v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2734</span>, <span style=color:#d699b6>2417</span>, <span style=color:#d699b6>3089</span>, <span style=color:#d699b6>2974</span>, <span style=color:#b2c98f>&#34;Bring Our Ignition Back&#34;</span>, <span style=color:#b2c98f>&#34;Unsan-musho&#34;</span>, <span style=color:#b2c98f>&#34;Electric Angel&#34;</span>, <span style=color:#b2c98f>&#34;Kegare Naki Bara Juuji&#34;</span>, <span style=color:#b2c98f>&#34;ex5v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2483</span>, <span style=color:#d699b6>2276</span>, <span style=color:#d699b6>2921</span>, <span style=color:#d699b6>3194</span>, <span style=color:#b2c98f>&#34;Defeat awaken battle ship&#34;</span>, <span style=color:#b2c98f>&#34;Extraction&#34;</span>, <span style=color:#b2c98f>&#34;Pastel Subliminal&#34;</span>, <span style=color:#b2c98f>&#34;Synthesized Fortress&#34;</span>, <span style=color:#b2c98f>&#34;ex6v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2846</span>, <span style=color:#d699b6>2260</span>, <span style=color:#d699b6>2333</span>, <span style=color:#d699b6>3347</span>, <span style=color:#b2c98f>&#34;LiFE Garden&#34;</span>, <span style=color:#b2c98f>&#34;Alpha&#34;</span>, <span style=color:#b2c98f>&#34;Stay Alive&#34;</span>, <span style=color:#b2c98f>&#34;Heaven&#39;s Fall&#34;</span>, <span style=color:#b2c98f>&#34;ex7v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>3789</span>, <span style=color:#d699b6>3663</span>, <span style=color:#d699b6>2424</span>, <span style=color:#d699b6>3255</span>, <span style=color:#b2c98f>&#34;Hayabusa&#34;</span>, <span style=color:#b2c98f>&#34;Shuu no hazama&#34;</span>, <span style=color:#b2c98f>&#34;Amatsukami&#34;</span>, <span style=color:#b2c98f>&#34;CRIMSON FIGHTER&#34;</span>, <span style=color:#b2c98f>&#34;ex8v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>3888</span>, <span style=color:#d699b6>3030</span>, <span style=color:#d699b6>3581</span>, <span style=color:#d699b6>3700</span>, <span style=color:#b2c98f>&#34;crazy_tek (DJ Noriken Remix)&#34;</span>, <span style=color:#b2c98f>&#34;Nhelv&#34;</span>, <span style=color:#b2c98f>&#34;Shuuten&#34;</span>, <span style=color:#b2c98f>&#34;Deadly force - Put an end&#34;</span>, <span style=color:#b2c98f>&#34;ex9v3&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e67e80>new</span> MaDan(<span style=color:#d699b6>2828</span>, <span style=color:#d699b6>3362</span>, <span style=color:#d699b6>3393</span>, <span style=color:#d699b6>5100</span>, <span style=color:#b2c98f>&#34;Infinity Heaven&#34;</span>, <span style=color:#b2c98f>&#34;NEURO-CLOUD-9&#34;</span>, <span style=color:#b2c98f>&#34;Kizuato&#34;</span>, <span style=color:#b2c98f>&#34;Runengon&#34;</span>, <span style=color:#b2c98f>&#34;exfinv3&#34;</span>),
</span></span><span style=display:flex><span>    ]
</span></span></code></pre></div><p>可以看到，简单地调用构造函数新建对象。继续实现：
我们可以写一个<code>init</code>函数，根据需要创建结构体变量。</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>Dan<span style=color:#7a8478>*</span> <span style=color:#b2c98f>dan_data_init</span>(Dan<span style=color:#7a8478>*</span>, <span style=color:#dbbc7f>int</span><span style=color:#7a8478>*</span> songs_key);
</span></span></code></pre></div><p>第二个参数是存放物量的数组，这样就实现了代码复用，减少重复代码的编写，定义一次所有物量即可。</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#859289;font-style:italic>// 常规段
</span></span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_1dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>813</span>, <span style=color:#d699b6>955</span>, <span style=color:#d699b6>907</span>, <span style=color:#d699b6>654</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_2dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1152</span>, <span style=color:#d699b6>850</span>, <span style=color:#d699b6>950</span>, <span style=color:#d699b6>969</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_3dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1169</span>, <span style=color:#d699b6>1143</span>, <span style=color:#d699b6>974</span>, <span style=color:#d699b6>1347</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_4dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1400</span>, <span style=color:#d699b6>1402</span>, <span style=color:#d699b6>1685</span>, <span style=color:#d699b6>1599</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_5dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1953</span>, <span style=color:#d699b6>2250</span>, <span style=color:#d699b6>2166</span>, <span style=color:#d699b6>1667</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_6dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1487</span>, <span style=color:#d699b6>1424</span>, <span style=color:#d699b6>1381</span>, <span style=color:#d699b6>1587</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_7dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1909</span>, <span style=color:#d699b6>1814</span>, <span style=color:#d699b6>1777</span>, <span style=color:#d699b6>2681</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_8dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1962</span>, <span style=color:#d699b6>1067</span>, <span style=color:#d699b6>2388</span>, <span style=color:#d699b6>1772</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_9dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>1799</span>, <span style=color:#d699b6>2023</span>, <span style=color:#d699b6>2283</span>, <span style=color:#d699b6>1787</span>};
</span></span><span style=display:flex><span><span style=color:#dbbc7f>int</span> mld_10dan_total_keys[] <span style=color:#7a8478>=</span> {<span style=color:#d699b6>2606</span>, <span style=color:#d699b6>2188</span>, <span style=color:#d699b6>2194</span>, <span style=color:#d699b6>2187</span>};
</span></span></code></pre></div><p>这里目前把常规段都录入了，那要怎么按需匹配创建结构体变量呢？可以通过一个指针数组保存这些数据数组的地址，然后根据用户输入的数字直接作为索引，创建结构体变量并进行初始化赋值。</p><p>优点：避免if/switch分支判断逐个比较，时间复杂度为常数阶。</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#dbbc7f>int</span><span style=color:#7a8478>*</span> dan_total_keys_index[] <span style=color:#7a8478>=</span> {mld_1dan_total_keys, mld_2dan_total_keys, mld_3dan_total_keys, mld_4dan_total_keys, mld_5dan_total_keys, mld_6dan_total_keys, mld_7dan_total_keys, mld_8dan_total_keys, mld_9dan_total_keys, mld_10dan_total_keys};
</span></span></code></pre></div><p>后续接着往这个数组里面装指针即可。</p><p>基本的数据结构实现了，就可以开始研究一下算法，后续再录入数据吧。</p><h2 id=算法实现>算法实现</h2><p>曾经听群友讲过这个东西核心理念是加权平均数，最近才学到，那就来看看怎么做这个平均数吧。</p><p>直接看原作者是怎么实现的</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span> <span style=color:#e67e80>function</span> normal_calculation(accArr, noteArr) {
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> score1 <span style=color:#7a8478>=</span> accArr[<span style=color:#d699b6>0</span>]
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> temp1 <span style=color:#7a8478>=</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>-</span> noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>0</span>]
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> score2 <span style=color:#7a8478>=</span> temp1 <span style=color:#7a8478>/</span> (noteArr[<span style=color:#d699b6>1</span>])
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> temp2 <span style=color:#7a8478>=</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>2</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>2</span>] <span style=color:#7a8478>-</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>1</span>]
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> score3 <span style=color:#7a8478>=</span> temp2 <span style=color:#7a8478>/</span> (noteArr[<span style=color:#d699b6>2</span>])
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> temp3 <span style=color:#7a8478>=</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>2</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>3</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>3</span>] <span style=color:#7a8478>-</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>2</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>2</span>]
</span></span><span style=display:flex><span>            <span style=color:#e67e80>let</span> score4 <span style=color:#7a8478>=</span> temp3 <span style=color:#7a8478>/</span> (noteArr[<span style=color:#d699b6>3</span>])
</span></span><span style=display:flex><span>            <span style=color:#e67e80>return</span> [score1, score2, score3, score4]
</span></span><span style=display:flex><span>        }
</span></span></code></pre></div><p>第一首的ACC不变，这个不说了。</p><p>这个temp算的是什么？？？</p><p>刚刚去看了一下引用，accArr存放着四首的玩家成绩Acc，noteArr存着这四首歌的Note总数量。</p><p>还是没搞明白这个temp在干什么，看这段代码是真想骂街啊。</p><p>用1dan举例子，Note和ACC：</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>813, 955, 907, 654
</span></span><span style=display:flex><span>99   98   96   94
</span></span></code></pre></div><p><del>叠批来了</del></p><p>Malody的每一个判定都有不同的权重，都有对应不同的Acc衰减，所以每一首歌曲结束后都是一个加权平均数。程序要做的事情就是逆推出原本的Acc。</p><p>所以<code>accArr</code>是一个累计加权平均值数组。
<code>noteArr</code>是每批数据的权重。
目标：计算每批数据的<strong>独立加权平均值</strong>。</p><h3 id=数学逻辑>数学逻辑</h3><p><strong>第一批数据：</strong></p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#e67e80>let</span> score1 <span style=color:#7a8478>=</span> accArr[<span style=color:#d699b6>0</span>]
</span></span></code></pre></div><p>直接使用第一个累计平均值a1，此时只有第一批数据。</p><p><strong>第二批数据：</strong></p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#e67e80>let</span> temp1 <span style=color:#7a8478>=</span> (noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> noteArr[<span style=color:#d699b6>1</span>]) <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>-</span> noteArr[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>*</span> accArr[<span style=color:#d699b6>0</span>] 
</span></span><span style=display:flex><span><span style=color:#e67e80>let</span> score2 <span style=color:#7a8478>=</span> temp1 <span style=color:#7a8478>/</span> noteArr[<span style=color:#d699b6>1</span>]
</span></span></code></pre></div><ul><li>累计平均值<code>a2 = (n1s1 +n2s2) / (n1 + n2)</code></li><li>解得<code>s2</code>:<code>(n1 +n2)a2 - n1s1 / n2</code>
&mldr;&mldr;</li></ul><p>额&mldr;这一顿推导，给我也整不会了。我数学奇烂，那就用一个简明易懂的例子来理解吧。</p><h3 id=人话>人话</h3><p>假设参加了4次考试</p><ul><li>第一次考了80分(score1)</li><li>第二次的平均分是93.3(accArr[1])</li><li>第三次的平均分是95(accArr[2])</li><li>第四次的平均分是97.5(accArr[3])</li></ul><p>但是你忘了每次考试的重要程度（权重）：</p><ul><li>第一次考试占10(noteArr[0] = 10)</li><li>第二次 20(noteArr[1] = 20)</li><li>第三次 30(noteArr[2] = 30)</li><li>第四次 40(noteArr[3] = 40)</li></ul><p>你想知道每次考试单独的平均分是多少</p><ol><li>第一次考试：
直接用平均分（因为只有一次考试）</li><li>第二次考试：
先算总分：<code>前两次总分 = (10+20)*93.3 = 2800</code>
减去第一次的分数：<code>第二次分数 = 2800 - 10 * 80 = 2000</code>
第二次平均分： <code>score2 = 2000 / 20 = 100</code></li><li>第三次考试：
总分：<code>(10 + 20 + 30 )*95 = 5700</code>
减去前两次：<code>第三次分数 = 5700 - 2800</code>
平均分：<code>score3 = 2900 / 30 ≈ 96.7</code></li><li>第四次考试
总分：<code>(10+20+30+40)*97.5 = 9750</code>
减去前3次：<code>第四次分数 = 9750 - 5700 = 4050</code>
平均分：<code>score4 = 4050 / 40 = 101.25</code></li></ol><p>写着写着突然发现</p><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#e67e80>typedef</span> <span style=color:#e67e80>struct</span> Dan
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 四首歌的物量
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>int</span><span style=color:#7a8478>*</span> songs_total_keys;
</span></span><span style=display:flex><span>} Dan;
</span></span></code></pre></div><p>这个数据结构只需要一个数组。</p><p>人话说完了，该说说计算机的话了。</p><h3 id=实现>实现</h3><div class=highlight><pre tabindex=0 style=color:#d6cbb4;background-color:#252b2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#dbbc7f>double</span> <span style=color:#7a8478>*</span><span style=color:#b2c98f>common_calc</span>(<span style=color:#dbbc7f>int</span> <span style=color:#7a8478>*</span>total_keys, <span style=color:#dbbc7f>double</span> <span style=color:#7a8478>*</span>player_acc)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 权重：total_keys
</span></span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 分数：player_acc
</span></span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 返回的数组，保存计算完成的Acc
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>double</span> <span style=color:#7a8478>*</span>result <span style=color:#7a8478>=</span> (<span style=color:#dbbc7f>double</span> <span style=color:#7a8478>*</span>)<span style=color:#b2c98f>malloc</span>(<span style=color:#e67e80>sizeof</span>(<span style=color:#dbbc7f>double</span>) <span style=color:#7a8478>*</span> <span style=color:#d699b6>4</span>);
</span></span><span style=display:flex><span>    <span style=color:#e67e80>if</span> (result <span style=color:#7a8478>==</span> <span style=color:#d699b6>NULL</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#b2c98f>printf</span>(<span style=color:#b2c98f>&#34;[ERROR] 内存分配失败！&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#e67e80>return</span> <span style=color:#d699b6>NULL</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#dbbc7f>double</span> song1_acc, song2_acc, song3_acc, song4_acc;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 第一首歌：直接取第一个累积平均值
</span></span></span><span style=display:flex><span>    result[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>=</span> player_acc[<span style=color:#d699b6>0</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 第二首歌：((n0 + n1)*a1 - n0*a0) / n1
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>double</span> sum2 <span style=color:#7a8478>=</span> total_keys[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>+</span> total_keys[<span style=color:#d699b6>1</span>];
</span></span><span style=display:flex><span>    result[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>=</span> (sum2 <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>1</span>] <span style=color:#7a8478>-</span> total_keys[<span style=color:#d699b6>0</span>] <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>0</span>]) <span style=color:#7a8478>/</span> total_keys[<span style=color:#d699b6>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 第三首歌：((n0 + n1 + n2)*a2 - (n0 + n1)*a1) / n2
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>double</span> sum3 <span style=color:#7a8478>=</span> sum2 <span style=color:#7a8478>+</span> total_keys[<span style=color:#d699b6>2</span>];
</span></span><span style=display:flex><span>    result[<span style=color:#d699b6>2</span>] <span style=color:#7a8478>=</span> (sum3 <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>2</span>] <span style=color:#7a8478>-</span> sum2 <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>1</span>]) <span style=color:#7a8478>/</span> total_keys[<span style=color:#d699b6>2</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#859289;font-style:italic>// 第四首歌：((n0 + n1 + n2 + n3)*a3 - (n0 + n1 + n2)*a2) / n3
</span></span></span><span style=display:flex><span>    <span style=color:#dbbc7f>double</span> sum4 <span style=color:#7a8478>=</span> sum3 <span style=color:#7a8478>+</span> total_keys[<span style=color:#d699b6>3</span>];
</span></span><span style=display:flex><span>    result[<span style=color:#d699b6>3</span>] <span style=color:#7a8478>=</span> (sum4 <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>3</span>] <span style=color:#7a8478>-</span> sum3 <span style=color:#7a8478>*</span> player_acc[<span style=color:#d699b6>2</span>]) <span style=color:#7a8478>/</span> total_keys[<span style=color:#d699b6>3</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e67e80>return</span> result;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后就是主函数处理用户输入了，没什么含金量，不水了。</p></div></article><a class=u-url href=https://www.glowisle.me/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/ style=display:none>Permalink</a><hr><div class=post-meta><div class="post-meta-item post-author"><p><svg t="1768726817979" class="icon" viewBox="0 0 1024 1024" p-id="4715" width="200" height="200"><path d="M858.5 763.6c-18.9-44.8-46.1-85-80.6-119.5s-74.7-61.6-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6-34.5 34.5-61.6 74.7-80.6 119.5C146.9 807.5 137 854 136 901.8c-.1 4.5 3.5 8.2 8 8.2h60c4.4.0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60c4.5.0 8.1-3.7 8-8.2-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9.0-89.1-17.9-121.6-50.4S340 407.9 340 362s17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362s-17.9 89.1-50.4 121.6S557.9 534 512 534z" p-id="4716"/></svg>
Verdant</p></div><div class="post-meta-item post-date"><svg t="1768727464189" class="icon" viewBox="0 0 1024 1024" p-id="5925" width="200" height="200"><path d="M341.333333 170.666667h341.333334V85.333333H768v85.333334h42.666667A85.333333 85.333333.0 01896 256v597.333333a85.333333 85.333333.0 01-85.333333 85.333334H213.333333A85.333333 85.333333.0 01128 853.333333V256a85.333333 85.333333.0 0185.333333-85.333333H256V85.333333h85.333333v85.333334zm-128 170.666666v512h597.333334v-512H213.333333zm85.333334 128H384v85.333334H298.666667v-85.333334zm170.666666.0h85.333334v85.333334h-85.333334v-85.333334zm170.666667.0h85.333333v85.333334H640v-85.333334zM640 640h85.333333v85.333333H640V640zm-170.666667.0h85.333334v85.333333h-85.333334V640zm-170.666666.0H384v85.333333H298.666667V640z" fill="#000" p-id="5926"/></svg>
<time class=dt-published datetime=2025-06-07T13:08:07Z>June 07, 2025</time></div><div class="post-meta-item post-category"><svg t="1768727819011" class="icon" viewBox="0 0 1024 1024" p-id="7095" width="200" height="200"><path d="M85.312 153.6v716.8h853.376V288H471.36L364.416 153.6H85.376zM0 64h404.288L511.36 198.4H1024V960H0V64z" fill="#262626" p-id="7096"/></svg>
<a href=/categories/%E5%BE%80%E6%98%94/ class=category-link>往昔</a></div><div class="post-meta-item post-tag"><svg t="1768727897449" class="icon" viewBox="0 0 1024 1024" p-id="8070" width="200" height="200"><path d="M512 910.208 910.208 512 480.832 82.624l-378.816 24.448L82.24 480.448 512 910.208zM0 512 25.472 31.36 512 0l512 512-512 512L0 512zm293.376-128.96a85.952 85.952.0 100-171.904 85.952 85.952.0 000 171.904z" fill="#262626" p-id="8071"/></svg>
<a href=https://www.glowisle.me/tags/malody/>Malody</a>
,
<a href=https://www.glowisle.me/tags/osu/>Osu</a>
,
<a href=https://www.glowisle.me/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/>数据结构与算法</a></div></div><div class=upvote-container><small class=upvote><button class=upvote-btn id=upvote-btn>
<svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg>
<span class=upvote-count id=upvote-count>0</span></button></small></div><script>let hasUpvoted=!1,upvoteBtn,upvoteCount;document.addEventListener("DOMContentLoaded",function(){const e="";upvoteBtn=document.getElementById("upvote-btn"),upvoteCount=document.getElementById("upvote-count"),getCount(e),upvoteBtn.addEventListener("click",handleUpvote)});async function handleUpvote(){if(hasUpvoted){console.log("You have already upvoted this post!");return}const e="";upvoteBtn.disabled=!0,upvoteBtn.classList.add("upvoted"),upvoteCount.innerText=parseInt(upvoteCount.innerText)+1;try{const t=await fetch("https://upvote.glowisle.me/upvote",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:e,diff:1})});t.ok?(console.log("Upvote successful!"),hasUpvoted=!0,await getCount(e,3)):console.log("Upvote failed!")}catch(e){console.error("Error: ",e)}finally{upvoteBtn.disabled=!1}}async function getCount(e,t=0){try{const n=await fetch("https://upvote.glowisle.me/count?post="+e,{method:"GET",headers:{"Content-Type":"application/json"}}),t=await n.json();if(t.code===0){const e=t.data.count;upvoteCount.innerText=e,hasUpvoted=t.data.hasUpvoted,hasUpvoted?upvoteBtn.classList.add("upvoted"):upvoteBtn.classList.remove("upvoted")}else console.error("Failed to get upvote count: ",t.msg)}catch(n){console.error("Error: ",n),t>0&&setTimeout(()=>{getCount(e,t-1)},1e3)}}</script><div class=toc><nav class=toc-nav><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#数据结构设计>数据结构设计</a></li><li><a href=#算法实现>算法实现</a><ul><li><a href=#数学逻辑>数学逻辑</a></li><li><a href=#人话>人话</a></li><li><a href=#实现>实现</a></li></ul></li></ul></nav></nav><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".toc-nav a"),n=Array.from(e).map(e=>{const t=e.getAttribute("href").replace("#","");return document.getElementById(t)}).filter(e=>e);e.forEach(t=>{t.addEventListener("click",function(t){t.preventDefault();const s=this.getAttribute("href").replace("#",""),n=document.getElementById(s);n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),e.forEach(e=>e.classList.remove("active")),this.classList.add("active"))})});function s(){const t=window.pageYOffset||document.documentElement.scrollTop,s=window.innerHeight;for(let t=n.length-1;t>=0;t--){const s=n[t],o=s.getBoundingClientRect();if(o.top<=100){e.forEach(e=>e.classList.remove("active"));const t=document.querySelector(`.toc-nav a[href="#${s.id}"]`);if(t){t.classList.add("active");let e=t.closest("li");for(;e;){const t=e.parentElement.closest("li");if(t){const n=t.querySelector("a");n&&n.classList.add("active"),e=t}else break}}break}}}let t=!1;function o(){t||(requestAnimationFrame(function(){s(),t=!1}),t=!0)}window.addEventListener("scroll",o),s()})</script></div><div class=comments-and-webmentions><details><summary><p style=display:inline>评论 与 Webmentions</p></summary><div id=giscus-container></div><div class=wm><div id=webmentions></div><script src=/js/webmention.min.js data-id=webmentions data-page-url=https://www.glowisle.me/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/ data-max-webmentions=50 data-wordcount=30 data-sort-by=published data-sort-dir=up async></script><p>若想回复本文，请在你的博客或社媒发布含有本文链接的帖子，然后在下方表单提交链接。</p><div class=wm-guide-content><div class=webmention-form><form id=webmention-submit-form action=https://webmention.io/www.glowisle.me/webmention method=post><input type=hidden name=target value=https://www.glowisle.me/posts/4key%E9%9F%B3%E6%B8%B8%E6%AE%B5%E4%BD%8D%E5%8D%95%E6%9B%B2%E6%88%90%E7%BB%A9%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0/><div><label for=webmention-source>你的文章链接：</label>
<input type=url id=webmention-source name=source required pattern=https?://.+>
<button type=submit id=webmention-submit-btn>提交</button></div><div id=webmention-form-feedback></div></form><p>也可以<a href="mailto:i@glowisle.me?subject=回复《4Key%e9%9f%b3%e6%b8%b8%e6%ae%b5%e4%bd%8d%e5%8d%95%e6%9b%b2%e6%88%90%e7%bb%a9%e8%ae%a1%e7%ae%97%e7%9a%84%e7%a8%8b%e5%ba%8f%e5%ae%9e%e7%8e%b0》">发送邮件</a>评论。</p><a href=https://indieweb.org/webmention>关于 Webmention 的更多信息</a>
以及
<a href=https://www.glowisle.me/posts/tear-hypocrisy-apart/>为什么要这么做？</a></div><script>function getInitialTheme(){return typeof localStorage!="undefined"&&localStorage.getItem("theme")?localStorage.getItem("theme"):window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const currentTheme=getInitialTheme(),giscusTheme=currentTheme==="dark"?"dark":"light",giscusScript=document.createElement("script");giscusScript.src="https://giscus.app/client.js",giscusScript.setAttribute("data-repo","yingyu5658/yingyu5658.github.io"),giscusScript.setAttribute("data-repo-id","R_kgDOOBetsA"),giscusScript.setAttribute("data-category","Announcements"),giscusScript.setAttribute("data-category-id","DIC_kwDOOBetsM4CoF_Z"),giscusScript.setAttribute("data-mapping","title"),giscusScript.setAttribute("data-strict","0"),giscusScript.setAttribute("data-reactions-enabled","0"),giscusScript.setAttribute("data-emit-metadata","0"),giscusScript.setAttribute("data-input-position","bottom"),giscusScript.setAttribute("data-theme",giscusTheme),giscusScript.setAttribute("data-lang","zh-CN"),giscusScript.crossOrigin="anonymous",giscusScript.async=!0,document.getElementById("giscus-container").appendChild(giscusScript),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("webmention-submit-form"),t=document.getElementById("webmention-submit-btn"),n=document.getElementById("webmention-form-feedback");if(!e)return;e.addEventListener("submit",async function(s){s.preventDefault();const o=t.textContent;t.disabled=!0,t.textContent="发送中...",n.textContent="";try{const o=new FormData(e),s=await fetch(e.action,{method:"POST",headers:{Accept:"application/json"},body:new URLSearchParams(o)}),t=await s.json();if(s.ok)n.textContent="✅ 提交成功！Webmention 正在处理中。",e.reset();else{let e="提交失败：";(t.error||t.summary)&&(e+=t.error||t.summary),n.textContent=e}}catch{n.textContent="❌ 提交过程中出现网络错误，请稍后重试。"}finally{t.disabled=!1,t.textContent=o}})})</script></div></div></details></div></main><footer><div class=copyright>© 2024 - 2026 | Made with ❤️ by Verdant.<div class=rss-icon><a href=/rss><i class="fa fa-rss"></i></a></div></div></footer></body></html>